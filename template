<?php
echo $title;
#echo toSlug('Phat Huy');
?>
public function getNameCategory()
  {
    $data = $this->db->table('category')->select('category_id, category_name')->limit(3, 1)->orderBy('category_id', 'ASC')->get();
    $data = $this->db->table('products')->join('category', 'products.category = category.id')->select('category.name as ten_danh_muc, products.product_name as ten_san_pham')->get();

    return $data;
  }
<h1>Trang Chủ</h1>
<h3>Sản Phẩm Mới</h3>
<p>Tên người dùng: <?php echo !empty($userInfo['user_name']) ? $userInfo['user_name'] : false; ?></p>
<p>Email người dùng: <?php echo !empty($userInfo['email']) ? $userInfo['email'] : false; ?></p>
<hr>
<?php foreach ($categoryAll as $item) : ?>
  <p>Tên danh mục: <?php echo $item['category_name'] ?></p>
<?php endforeach; ?>
<?php
class Template
{
    private $__content = null;
    public function run($content, $data = [])
    {
        extract($data);

        $this->__content = $content;

        $this->printEntities();

        $this->printRaw();

        $this->ifCondition();
        
        eval('?>' . $this->__content . '<?php');
    }

    public function printEntities()
    {
        preg_match_all('~{{\s*(.+?)\s*}}~is', $this->__content, $matches);
        if (!empty($matches[1])) {
            foreach ($matches[1] as $key => $item) {
                $this->__content = str_replace($matches[0][$key], '<?php echo htmlentities(' . $item . '); ?>', $this->__content);
            }
        }
    }

    public function printRaw()
    {
        preg_match_all('~{!\s*(.+?)\s*!}~is', $this->__content, $matches);
        if (!empty($matches[1])) {
            foreach ($matches[1] as $key => $item) {
                $this->__content = str_replace($matches[0][$key], '<?php echo ' . $item . '; ?>', $this->__content);
            }
        }
    }

    public function ifCondition()
    {
        preg_match_all('~@if\s*\((.+?)\s*\)\s*$~im', $this->__content, $matches);
        if (!empty($matches[1])) {
            foreach ($matches[1] as $key => $item) {
                $this->__content = str_replace($matches[0][$key], '<?php if (' . $item . '): ?>', $this->__content);
            }
        }

        preg_match_all('~@else\s*$~im', $this->__content, $matches);
        if (!empty($matches[0])) {
            foreach ($matches[0] as $key => $item) {
                $this->__content = str_replace($matches[0][$key], '<?php else: ?>', $this->__content);
            }
        }

        preg_match_all('~@endif\s*$~im', $this->__content, $matches);
        if (!empty($matches[0])) {
            foreach ($matches[0] as $key => $item) {
                $this->__content = str_replace($matches[0][$key], '<?php endif; ?>', $this->__content);
            }
        }
    }
}
?>


{{$title}} => <?php echo htmlentities($title); ?>
{!$title!} => <?php echo $title; ?>
{!toSlug('Phat huy')!} => <?php echo toSlug('Phat Huy'); ?>

{{$home_price}}</br>
{{toSlug($home_name)}}</br>
{!$home_sale!}</br>
{{!empty($home_hehe) ? $home_hehe : 'Ko co gi' }}</br>
@if (md5('1234') != '')
<p>Mật khẩu: {{md5('1234')}}</p>
@endif

{{$product_title}}</br>
{{$product_price}}</br>
{{'Phat Huy'}}</br>
{{toSlug($product_name)}}</br>
{! $product_sale !}</br>
{{!empty($product_hehe) ? $product_hehe : 'Ko co gi' }}</br>
{{md5('1443')}}</br>
@if (!empty($product_title))
<p>Tên tôi: {{$product_title}}</p>
@else
<p>Không có gì!</p>
@endif